<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TcpInstruments</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TcpInstruments</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li class="toplevel"><a class="tocitem" href="#Initialize-automatically-puts-this-power-supply-in-remote-mode"><span>Initialize automatically puts this power supply in remote mode</span></a></li><li class="toplevel"><a class="tocitem" href="#Closes-connection-as-with-other-devices-but-also-puts-this"><span>Closes connection as with other devices but also puts this</span></a></li><li class="toplevel"><a class="tocitem" href="#device-back-into-local-mode"><span>device back into local mode</span></a></li><li class="toplevel"><a class="tocitem" href="#Turn-on-Low-Pass-Filter-25MHz"><span>Turn on Low Pass Filter 25MHz</span></a></li><li class="toplevel"><a class="tocitem" href="#See-that-low-pass-filter-is-on"><span>See that low pass filter is on</span></a></li><li class="toplevel"><a class="tocitem" href="#Turn-Off-Low-Pass-Filter-25MHz"><span>Turn Off Low Pass Filter 25MHz</span></a></li><li class="toplevel"><a class="tocitem" href="#See-that-low-pass-filter-is-off"><span>See that low pass filter is off</span></a></li><li class="toplevel"><a class="tocitem" href="#Get-data-from-channel-1"><span>Get data from channel 1</span></a></li><li class="toplevel"><a class="tocitem" href="#Get-data-from-channel-1,-2,-and-4"><span>Get data from channel 1, 2, &amp; 4</span></a></li><li class="toplevel"><a class="tocitem" href="#Returns-3-element-array-of-data-from-each-channel"><span>Returns 3 element array of data from each channel</span></a></li><li class="toplevel"><a class="tocitem" href="#Plots-channel-1"><span>Plots channel 1</span></a></li><li class="toplevel"><a class="tocitem" href="#Plots-channel-2"><span>Plots channel 2</span></a></li><li class="toplevel"><a class="tocitem" href="#Plots-channel-4"><span>Plots channel 4</span></a></li><li class="toplevel"><a class="tocitem" href="#Saves-data-to-a-file"><span>Saves data to a file</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="instruments/">Supported Instruments</a></li><li><a class="tocitem" href="general_functions/">General Functions</a></li><li><a class="tocitem" href="instrument_functions/">Instrument-specific Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gita135/TcpInstruments.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TcpInstruments.jl"><a class="docs-heading-anchor" href="#TcpInstruments.jl">TcpInstruments.jl</a><a id="TcpInstruments.jl-1"></a><a class="docs-heading-anchor-permalink" href="#TcpInstruments.jl" title="Permalink"></a></h1><p>TcpInstruments allows you to control a variety of internet-enabled instruments</p><p>SCPI is supported on almost all modern pieces of lab equipment and this code has during development been tested on the following devices:</p><ul><li>Oscilloscope Keysight DSOX4034A</li><li>Oscilloscope Keysight DSOX4024A</li><li>Multimeter Keysight DMM34465A</li><li>Signal generator Keysight 33612A</li><li>Power supply Agilent E36312A</li><li>HV power supply SRS PS310 via Prologix GPIB to Ethernet adaptor</li><li>Power supply Versatile Power 100-10 XR</li><li>Impedance analyser Agilent 4294A</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>TcpInstruments can be installed using the Julia package manager. From the Julia REPL, type ] to enter the Pkg REPL mode and run</p><pre><code class="nohighlight hljs">pkg&gt; add TcpInstruments</code></pre><p>To see the different types of devices you can interface with, run:</p><pre><code class="nohighlight hljs">julia&gt; ?
help?&gt; Instrument</code></pre><p>Autoinitialize - Storage of name-aliases and IP addresses.</p><p>You can create a <code>~/.tcp_instruments.yml</code> file which stores the IP-address  and an optional name-alias for all your devices in one easy-to-find place so they don&#39;t have to be hardcoded in scripts.</p><p>To create an example config file that can be edited to your needs run:</p><pre><code class="nohighlight hljs">create_config()</code></pre><p>This will create a yaml file in your home directory: <code>~/.tcp_instruments.yml</code></p><p>This yaml file will be loaded everytime you use this package.</p><p>You can also create a project-specific config by creating the config in your project root directory instead of your home directory. You can do this with:</p><pre><code class="nohighlight hljs">create_config(pwd())</code></pre><p>Once you have created a config file you can change it with</p><pre><code class="nohighlight hljs">edit_config()</code></pre><p>Format of <code>.tcp_instruments.yml</code> file:</p><pre><code class="language-julia hljs">{name-of-device}:
    address: &quot;{ip-address}&quot;

# GPIB Device connected with a prologix controller
{name-of-device}:
    gpib: {channel-number}
    address: &quot;{ip-address}&quot;</code></pre><p>Let&#39;s create a new <code>.tcp_instruments.yml</code> file or ensure the two previous devices are found in our <code>.tcp_instruments.yml</code> file</p><pre><code class="language-yaml hljs">Keysight33612A:
    address: &quot;10.1.30.36&quot;
    alias: &quot;OleBigSG&quot;
SRSPS310:
    gpib: 2
    address: &quot;10.1.30.37:1234&quot;</code></pre><p>Recompile the new config which is located in the current working directory</p><pre><code class="language-julia hljs">pkg&gt; activate .
julia&gt; using TcpInstruments</code></pre><p>Each TcpInstruments will first look for a config in the current directory and if none is found it will look in the home directory.</p><p>The two devices from above can now be initialized as follows:</p><pre><code class="language-julia hljs">sg = initialize(Keysight33612A)
p = initialize(SRSPS310)</code></pre><p>Cool Tip: Since we specified an alias for the signal generator we can initialize it this way as well:</p><pre><code class="language-julia hljs">sg = initialize(OleBigSG)</code></pre><p>(No dashes, spaces or other special characters in alias names, treat them like variables, because they are.)</p><p>To send custom commands where no return response is expected use the <code>write()</code> function:</p><pre><code class="language-julia hljs">    julia&gt; write(instr, &quot;&lt;SCPI command&gt;&quot;)
    ```
    
    If the device is sending a response to the command use `query()` instead:
    ```julia
    julia&gt; response = query(instr, &quot;&lt;SCPI command&gt;&quot;)
    ```
    The convenience functions `f_query()` and `i_query()` parse the response string to a `Float64` and `Int64`, respectively.

## General Usage

To connect to an instrument you must know its model and
IP address:
</code></pre><p>julia using TcpInstruments instrument<em>handle = initialize(AgilentDSOX4034A, &quot;10.1.30.32&quot;) info(instrument</em>handle) data = get<em>data(instrument</em>handle) save(data)</p><pre><code class="nohighlight hljs">When you are done you can close your connection:</code></pre><p>julia terminate(instrument_handle)</p><pre><code class="nohighlight hljs">
If you do not know the ip address of any devices on your network:</code></pre><p>julia scan_network()</p><pre><code class="nohighlight hljs">
By default `scan_network` will check the addresses between
10.1.30.1 to 10.1.30.255 but you may need to scan a different range,
say: 10.1.150.1-255</code></pre><p>julia scan<em>network(; ip</em>network=&quot;10.1.150.&quot;)</p><pre><code class="nohighlight hljs">
## Units

This package uses Unitful.

In order to control certain devices
it is required to run:</code></pre><p>julia using Unitful</p><pre><code class="nohighlight hljs">
Commands such as:</code></pre><p>julia set<em>voltage</em>offset(instr, 0)</p><pre><code class="nohighlight hljs">will not work you must specify the units:</code></pre><p>julia set<em>voltage</em>offset(instr, 0u&quot;V&quot;)</p><pre><code class="nohighlight hljs">
## Examples
### Continious sine wave with a signal generator (in this case the Keysight 33612A):</code></pre><p>julia sg = initialize(Keysight33612A, &quot;10.1.30.36&quot;) set<em>mode</em>cw(sg)               # Set to continuous waveform mode set<em>function(sg, &quot;SIN&quot;) set</em>frequency(sg, 1u&quot;kHz&quot;) set<em>amplitude(sg, 0.1u&quot;V&quot;) set</em>voltage<em>offset(sg, 100u&quot;mV&quot;) enable</em>output(sg)             # sine output starts here</p><pre><code class="nohighlight hljs">

## Power Supplies

### VersatilePower
 </code></pre><p>julia</p><h1 id="Initialize-automatically-puts-this-power-supply-in-remote-mode"><a class="docs-heading-anchor" href="#Initialize-automatically-puts-this-power-supply-in-remote-mode">Initialize automatically puts this power supply in remote mode</a><a id="Initialize-automatically-puts-this-power-supply-in-remote-mode-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-automatically-puts-this-power-supply-in-remote-mode" title="Permalink"></a></h1><p>pwr = initialize(VersatilePower)</p><p>set<em>voltage(pwr, 20u&quot;V&quot;) set</em>current<em>limit(pwr, 4u&quot;A&quot;) enable</em>output(pwr)</p><h1 id="Closes-connection-as-with-other-devices-but-also-puts-this"><a class="docs-heading-anchor" href="#Closes-connection-as-with-other-devices-but-also-puts-this">Closes connection as with other devices but also puts this</a><a id="Closes-connection-as-with-other-devices-but-also-puts-this-1"></a><a class="docs-heading-anchor-permalink" href="#Closes-connection-as-with-other-devices-but-also-puts-this" title="Permalink"></a></h1><h1 id="device-back-into-local-mode"><a class="docs-heading-anchor" href="#device-back-into-local-mode">device back into local mode</a><a id="device-back-into-local-mode-1"></a><a class="docs-heading-anchor-permalink" href="#device-back-into-local-mode" title="Permalink"></a></h1><p>terminate(pwr)</p><pre><code class="nohighlight hljs">
### AgilentE36312A
 </code></pre><p>julia pwr = initialize(AgilentE36312A)</p><p>set<em>channel(pwr, 1) set</em>current<em>limit(pwr, 1) set</em>voltage(pwr, 2u&quot;V&quot;) enable_output(pwr) # Enables output on channel 1</p><p>set<em>channel(pwr, 2) set</em>voltage(pwr, 10u&quot;V&quot;) enable_output(pwr) # Enables output on channel 2</p><p>set<em>channel(pwr, 3) set</em>voltage(pwr, 10u&quot;V&quot;)</p><p>set_voltage(pwr, 0u&quot;V&quot;; chan=1) # Changes voltage of channel 1</p><p>get<em>voltage(pwr) # Get voltage channel 3 get</em>voltage(pwr; chan=2) get_voltage(pwr; chan=1)</p><p>enable_output(pwr) # Enables output on channel 3</p><pre><code class="nohighlight hljs">

### GPIB Power Supply (SRSPS310) used with Prologix Controller
 
To a initialize a device that is connected with a prologix
controller you must specify what prologix channel the device
is on. At this moment the prologix adapter is the only supported
GPIB to Ethernet adapter.</code></pre><p>julia p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;; GPIB_ID=2)</p><pre><code class="nohighlight hljs">If you don&#39;t know the channel you can figure it out and configure
it manually:</code></pre><p>julia julia&gt; using TcpInstruments julia&gt; p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;) julia&gt; scan<em>prologix(p) 2 =&gt; &quot;PS310&quot; julia&gt; set</em>prologix(p, 2) julia&gt; get_prologix(p) 2</p><pre><code class="nohighlight hljs">Using SRSPS310 Power Supply:</code></pre><p>julia p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;; GPIB<em>ID=2) set</em>voltage<em>limit(p, 1250u&quot;V&quot;) set</em>voltage(p, 1250u&quot;V&quot;) set<em>current</em>limit(p, 0.021u&quot;A&quot;) # equivalent to set<em>current</em>limit(p, 21u&quot;mA&quot;) enable_output(p)</p><pre><code class="nohighlight hljs">
## Oscilloscopes

### AgilentDSOX4034A
 
</code></pre><p>julia scope = initialize(AgilentDSOX4034A)</p><h1 id="Turn-on-Low-Pass-Filter-25MHz"><a class="docs-heading-anchor" href="#Turn-on-Low-Pass-Filter-25MHz">Turn on Low Pass Filter 25MHz</a><a id="Turn-on-Low-Pass-Filter-25MHz-1"></a><a class="docs-heading-anchor-permalink" href="#Turn-on-Low-Pass-Filter-25MHz" title="Permalink"></a></h1><p>lpf_on(scope)</p><h1 id="See-that-low-pass-filter-is-on"><a class="docs-heading-anchor" href="#See-that-low-pass-filter-is-on">See that low pass filter is on</a><a id="See-that-low-pass-filter-is-on-1"></a><a class="docs-heading-anchor-permalink" href="#See-that-low-pass-filter-is-on" title="Permalink"></a></h1><p>get<em>lpf</em>state(scope)</p><h1 id="Turn-Off-Low-Pass-Filter-25MHz"><a class="docs-heading-anchor" href="#Turn-Off-Low-Pass-Filter-25MHz">Turn Off Low Pass Filter 25MHz</a><a id="Turn-Off-Low-Pass-Filter-25MHz-1"></a><a class="docs-heading-anchor-permalink" href="#Turn-Off-Low-Pass-Filter-25MHz" title="Permalink"></a></h1><p>lpf_off(scope)</p><h1 id="See-that-low-pass-filter-is-off"><a class="docs-heading-anchor" href="#See-that-low-pass-filter-is-off">See that low pass filter is off</a><a id="See-that-low-pass-filter-is-off-1"></a><a class="docs-heading-anchor-permalink" href="#See-that-low-pass-filter-is-off" title="Permalink"></a></h1><p>get<em>lpf</em>state(scope)</p><p>set<em>impedance</em>1Mohm(scope) @info get_impedance(scope)</p><p>set<em>impedance</em>50ohm(scope) @info get_impedance(scope)</p><h1 id="Get-data-from-channel-1"><a class="docs-heading-anchor" href="#Get-data-from-channel-1">Get data from channel 1</a><a id="Get-data-from-channel-1-1"></a><a class="docs-heading-anchor-permalink" href="#Get-data-from-channel-1" title="Permalink"></a></h1><p>data = get_data(scope, 1)</p><h1 id="Get-data-from-channel-1,-2,-and-4"><a class="docs-heading-anchor" href="#Get-data-from-channel-1,-2,-and-4">Get data from channel 1, 2, &amp; 4</a><a id="Get-data-from-channel-1,-2,-and-4-1"></a><a class="docs-heading-anchor-permalink" href="#Get-data-from-channel-1,-2,-and-4" title="Permalink"></a></h1><h1 id="Returns-3-element-array-of-data-from-each-channel"><a class="docs-heading-anchor" href="#Returns-3-element-array-of-data-from-each-channel">Returns 3 element array of data from each channel</a><a id="Returns-3-element-array-of-data-from-each-channel-1"></a><a class="docs-heading-anchor-permalink" href="#Returns-3-element-array-of-data-from-each-channel" title="Permalink"></a></h1><p>multi<em>data = get</em>data(scope, [1,2, 4])</p><p>using Plots</p><p>plot(data)</p><h1 id="Plots-channel-1"><a class="docs-heading-anchor" href="#Plots-channel-1">Plots channel 1</a><a id="Plots-channel-1-1"></a><a class="docs-heading-anchor-permalink" href="#Plots-channel-1" title="Permalink"></a></h1><p>plot(multi_data[1])</p><h1 id="Plots-channel-2"><a class="docs-heading-anchor" href="#Plots-channel-2">Plots channel 2</a><a id="Plots-channel-2-1"></a><a class="docs-heading-anchor-permalink" href="#Plots-channel-2" title="Permalink"></a></h1><p>plot(multi_data[2])</p><h1 id="Plots-channel-4"><a class="docs-heading-anchor" href="#Plots-channel-4">Plots channel 4</a><a id="Plots-channel-4-1"></a><a class="docs-heading-anchor-permalink" href="#Plots-channel-4" title="Permalink"></a></h1><p>plot(multi_data[3])</p><h1 id="Saves-data-to-a-file"><a class="docs-heading-anchor" href="#Saves-data-to-a-file">Saves data to a file</a><a id="Saves-data-to-a-file-1"></a><a class="docs-heading-anchor-permalink" href="#Saves-data-to-a-file" title="Permalink"></a></h1><p>save(multi_data)</p><pre><code class="nohighlight hljs">
Additionally you can grab data from all open channels
(Let&#39;s say only channels 1 &amp; 2 are activated for now)</code></pre><p>julia scope = initialize(AgilentDSOX4034A) data = get_data(scope)    </p><pre><code class="nohighlight hljs">Since the only activated channels are now only 1 &amp; 2 this returns an array of waves (equivalent to `get_data(scope, [1,2]))

You can also plot multiple waves at once:</code></pre><p>julia plot(data)</p><pre><code class="nohighlight hljs">
![wave](examples/wave.png)


## Impedance Analyzers
TODO: example with the Agilent4294A.

## Multiple devices
 
Lets say you want to use a signal generator, power supply
and oscilloscope all at once.</code></pre><p>julia using TcpInstruments using Plots; plotly()</p><p>scope = initialize(AgilentDSOX4034A) pwr   = initialize(VersatilePower) sg    = initialize(Keysight33612A)</p><p>set<em>mode</em>cw(sg) set<em>function(sg, &quot;SIN&quot;) set</em>frequency(sg, 1000u&quot;Hz&quot;) set<em>amplitude(sg, 0.1u&quot;A&quot;) set</em>voltage<em>offset(sg, 0u&quot;V&quot;) enable</em>output(sg)</p><p>set<em>voltage(pwr, 20u&quot;V&quot;) set</em>current<em>limit(pwr, 4u&quot;A&quot;) enable</em>output(pwr)</p><p>data<em>array = get</em>data(scope, [1,2]) plot(data_array) ```</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="instruments/">Supported Instruments »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 21 October 2022 22:05">Friday 21 October 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
