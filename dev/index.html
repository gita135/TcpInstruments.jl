<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TcpInstruments</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TcpInstruments</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#General-Usage"><span>General Usage</span></a></li><li><a class="tocitem" href="#Units"><span>Units</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="instruments/">Supported Instruments</a></li><li><a class="tocitem" href="general_functions/">General Functions</a></li><li><a class="tocitem" href="instrument_functions/">Instrument-specific Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gita135/TcpInstruments.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TcpInstruments.jl"><a class="docs-heading-anchor" href="#TcpInstruments.jl">TcpInstruments.jl</a><a id="TcpInstruments.jl-1"></a><a class="docs-heading-anchor-permalink" href="#TcpInstruments.jl" title="Permalink"></a></h1><p>TcpInstruments allows you to control a variety of internet-enabled instruments</p><p>SCPI is supported on almost all modern pieces of lab equipment and this code has during development been tested on the following devices:</p><ul><li>Oscilloscope Keysight DSOX4034A</li><li>Oscilloscope Keysight DSOX4024A</li><li>Multimeter Keysight DMM34465A</li><li>Signal generator Keysight 33612A</li><li>Power supply Agilent E36312A</li><li>HV power supply SRS PS310 via Prologix GPIB to Ethernet adaptor</li><li>Power supply Versatile Power 100-10 XR</li><li>Impedance analyzer Agilent 4294A</li><li>SourceMeasureUnit Agilent B2910BL</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>TcpInstruments can be installed using the Julia package manager. From the Julia REPL, type ] to enter the Pkg REPL mode and run</p><pre><code class="nohighlight hljs">pkg&gt; add TcpInstruments</code></pre><p>To see the different types of devices you can interface with, run:</p><pre><code class="nohighlight hljs">julia&gt; ?
help?&gt; Instrument</code></pre><p>Autoinitialize - Storage of name-aliases and IP addresses.</p><p>You can create a <code>~/.tcp_instruments.yml</code> file which stores the IP-address  and an optional name-alias for all your devices in one easy-to-find place so they don&#39;t have to be hardcoded in scripts.</p><p>To create an example config file that can be edited to your needs run:</p><pre><code class="nohighlight hljs">create_config()</code></pre><p>This will create a yaml file in your home directory: <code>~/.tcp_instruments.yml</code></p><p>This yaml file will be loaded everytime you use this package.</p><p>You can also create a project-specific config by creating the config in your project root directory instead of your home directory. You can do this with:</p><pre><code class="nohighlight hljs">create_config(pwd())</code></pre><p>Once you have created a config file you can change it with</p><pre><code class="nohighlight hljs">edit_config()</code></pre><p>Format of <code>.tcp_instruments.yml</code> file:</p><pre><code class="language-julia hljs">{name-of-device}:
    address: &quot;{ip-address}&quot;

# GPIB Device connected with a prologix controller
{name-of-device}:
    gpib: {channel-number}
    address: &quot;{ip-address}&quot;</code></pre><p>Let&#39;s create a new <code>.tcp_instruments.yml</code> file or ensure the two previous devices are found in our <code>.tcp_instruments.yml</code> file</p><pre><code class="language-yaml hljs">Keysight33612A:
    address: &quot;10.1.30.36&quot;
    alias: &quot;OleBigSG&quot;
SRSPS310:
    gpib: 2
    address: &quot;10.1.30.37:1234&quot;</code></pre><p>Recompile the new config which is located in the current working directory</p><pre><code class="language-julia hljs">pkg&gt; activate .
julia&gt; using TcpInstruments</code></pre><p>Each TcpInstruments will first look for a config in the current directory and if none is found it will look in the home directory.</p><p>The two devices from above can now be initialized as follows:</p><pre><code class="language-julia hljs">sg = initialize(Keysight33612A)
p = initialize(SRSPS310)</code></pre><p>Cool Tip: Since we specified an alias for the signal generator we can initialize it this way as well:</p><pre><code class="language-julia hljs">sg = initialize(OleBigSG)</code></pre><p>(No dashes, spaces or other special characters in alias names, treat them like variables, because they are.)</p><p>To send custom commands where no return response is expected use the <code>write()</code> function:</p><pre><code class="language-julia hljs">julia&gt; write(instr, &quot;&lt;SCPI command&gt;&quot;)</code></pre><p>If the device is sending a response to the command use <code>query()</code> instead:</p><pre><code class="language-julia hljs">julia&gt; response = query(instr, &quot;&lt;SCPI command&gt;&quot;)</code></pre><p>The convenience functions <code>f_query()</code> and <code>i_query()</code> parse the response string to a <code>Float64</code> and <code>Int64</code>, respectively.</p><h2 id="General-Usage"><a class="docs-heading-anchor" href="#General-Usage">General Usage</a><a id="General-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#General-Usage" title="Permalink"></a></h2><p>To connect to an instrument you must know its model and IP address:</p><pre><code class="language-julia hljs">using TcpInstruments
instrument_handle = initialize(AgilentDSOX4034A, &quot;10.1.30.32&quot;)
info(instrument_handle)
data = get_data(instrument_handle)
save(data)</code></pre><p>When you are done you can close your connection:</p><pre><code class="language-julia hljs">terminate(instrument_handle)</code></pre><p>If you do not know the ip address of any devices on your network:</p><pre><code class="language-julia hljs">scan_network()</code></pre><p>By default <code>scan_network</code> will check the addresses between 10.1.30.1 to 10.1.30.255 but you may need to scan a different range, say: 10.1.150.1-255</p><pre><code class="language-julia hljs">scan_network(; ip_network=&quot;10.1.150.&quot;)</code></pre><h2 id="Units"><a class="docs-heading-anchor" href="#Units">Units</a><a id="Units-1"></a><a class="docs-heading-anchor-permalink" href="#Units" title="Permalink"></a></h2><p>This package uses Unitful.</p><p>In order to control certain devices it is required to run:</p><pre><code class="language-julia hljs">using Unitful</code></pre><p>Commands such as:</p><pre><code class="language-julia hljs">set_voltage_offset(instr, 0)</code></pre><p>will not work you must specify the units:</p><pre><code class="language-julia hljs">set_voltage_offset(instr, 0u&quot;V&quot;)</code></pre><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="Continious-sine-wave-with-a-signal-generator-(in-this-case-the-Keysight-33612A):"><a class="docs-heading-anchor" href="#Continious-sine-wave-with-a-signal-generator-(in-this-case-the-Keysight-33612A):">Continious sine wave with a signal generator (in this case the Keysight 33612A):</a><a id="Continious-sine-wave-with-a-signal-generator-(in-this-case-the-Keysight-33612A):-1"></a><a class="docs-heading-anchor-permalink" href="#Continious-sine-wave-with-a-signal-generator-(in-this-case-the-Keysight-33612A):" title="Permalink"></a></h3><pre><code class="language-julia hljs">sg = initialize(Keysight33612A, &quot;10.1.30.36&quot;)
set_mode_cw(sg)               # Set to continuous waveform mode
set_function(sg, &quot;SIN&quot;)
set_frequency(sg, 1u&quot;kHz&quot;)
set_amplitude(sg, 0.1u&quot;V&quot;)
set_voltage_offset(sg, 100u&quot;mV&quot;)
enable_output(sg)             # sine output starts here</code></pre><h3 id="Power-Supplies"><a class="docs-heading-anchor" href="#Power-Supplies">Power Supplies</a><a id="Power-Supplies-1"></a><a class="docs-heading-anchor-permalink" href="#Power-Supplies" title="Permalink"></a></h3><h4 id="VersatilePower"><a class="docs-heading-anchor" href="#VersatilePower">VersatilePower</a><a id="VersatilePower-1"></a><a class="docs-heading-anchor-permalink" href="#VersatilePower" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Initialize automatically puts this power supply in remote mode
pwr = initialize(VersatilePower)

set_voltage(pwr, 20u&quot;V&quot;)
set_current_limit(pwr, 4u&quot;A&quot;)
enable_output(pwr)

# Closes connection as with other devices but also puts this
# device back into local mode
terminate(pwr)</code></pre><h4 id="AgilentE36312A"><a class="docs-heading-anchor" href="#AgilentE36312A">AgilentE36312A</a><a id="AgilentE36312A-1"></a><a class="docs-heading-anchor-permalink" href="#AgilentE36312A" title="Permalink"></a></h4><pre><code class="language-julia hljs">pwr = initialize(AgilentE36312A)

set_channel(pwr, 1)
set_current_limit(pwr, 1)
set_voltage(pwr, 2u&quot;V&quot;)
enable_output(pwr) # Enables output on channel 1

set_channel(pwr, 2)
set_voltage(pwr, 10u&quot;V&quot;)
enable_output(pwr) # Enables output on channel 2

set_channel(pwr, 3)
set_voltage(pwr, 10u&quot;V&quot;)

set_voltage(pwr, 0u&quot;V&quot;; chan=1) # Changes voltage of channel 1

get_voltage(pwr) # Get voltage channel 3
get_voltage(pwr; chan=2)
get_voltage(pwr; chan=1)

enable_output(pwr) # Enables output on channel 3</code></pre><h4 id="GPIB-Power-Supply-(SRSPS310)-used-with-Prologix-Controller"><a class="docs-heading-anchor" href="#GPIB-Power-Supply-(SRSPS310)-used-with-Prologix-Controller">GPIB Power Supply (SRSPS310) used with Prologix Controller</a><a id="GPIB-Power-Supply-(SRSPS310)-used-with-Prologix-Controller-1"></a><a class="docs-heading-anchor-permalink" href="#GPIB-Power-Supply-(SRSPS310)-used-with-Prologix-Controller" title="Permalink"></a></h4><p>To a initialize a device that is connected with a prologix controller you must specify what prologix channel the device is on. At this moment the prologix adapter is the only supported GPIB to Ethernet adapter.</p><pre><code class="language-julia hljs">p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;; GPIB_ID=2)</code></pre><p>If you don&#39;t know the channel you can figure it out and configure it manually:</p><pre><code class="language-julia hljs">julia&gt; using TcpInstruments
julia&gt; p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;)
julia&gt; scan_prologix(p)
2 =&gt; &quot;PS310&quot;
julia&gt; set_prologix(p, 2)
julia&gt; get_prologix(p)
2</code></pre><p>Using SRSPS310 Power Supply:</p><pre><code class="language-julia hljs">p = initialize(SRSPS310, &quot;10.1.30.37:1234&quot;; GPIB_ID=2)
set_voltage_limit(p, 1250u&quot;V&quot;)
set_voltage(p, 1250u&quot;V&quot;)
set_current_limit(p, 0.021u&quot;A&quot;) # equivalent to set_current_limit(p, 21u&quot;mA&quot;)
enable_output(p)</code></pre><h3 id="Oscilloscopes"><a class="docs-heading-anchor" href="#Oscilloscopes">Oscilloscopes</a><a id="Oscilloscopes-1"></a><a class="docs-heading-anchor-permalink" href="#Oscilloscopes" title="Permalink"></a></h3><h4 id="AgilentDSOX4034A"><a class="docs-heading-anchor" href="#AgilentDSOX4034A">AgilentDSOX4034A</a><a id="AgilentDSOX4034A-1"></a><a class="docs-heading-anchor-permalink" href="#AgilentDSOX4034A" title="Permalink"></a></h4><pre><code class="language-julia hljs">scope = initialize(AgilentDSOX4034A)

# Turn on Low Pass Filter 25MHz
lpf_on(scope)

# See that low pass filter is on
get_lpf_state(scope)

# Turn Off Low Pass Filter 25MHz
lpf_off(scope)

# See that low pass filter is off
get_lpf_state(scope)


set_impedance_1Mohm(scope)
@info get_impedance(scope)

set_impedance_50ohm(scope)
@info get_impedance(scope)

# Get data from channel 1
data = get_data(scope, 1)

# Get data from channel 1, 2, &amp; 4
# Returns 3 element array of data from each channel
multi_data = get_data(scope, [1,2, 4])


using Plots

plot(data)

# Plots channel 1
plot(multi_data[1])

# Plots channel 2
plot(multi_data[2])

# Plots channel 4
plot(multi_data[3])

# Saves data to a file
save(multi_data)</code></pre><p>Additionally you can grab data from all open channels (Let&#39;s say only channels 1 &amp; 2 are activated for now)</p><pre><code class="language-julia hljs">scope = initialize(AgilentDSOX4034A)
data = get_data(scope)    </code></pre><p>Since the only activated channels are now only 1 &amp; 2 this returns an array of waves (equivalent to `get_data(scope, [1,2]))</p><p>You can also plot multiple waves at once:</p><pre><code class="language-julia hljs">plot(data)</code></pre><p><img src="examples/wave.png" alt="wave"/></p><h3 id="Impedance-Analyzers"><a class="docs-heading-anchor" href="#Impedance-Analyzers">Impedance Analyzers</a><a id="Impedance-Analyzers-1"></a><a class="docs-heading-anchor-permalink" href="#Impedance-Analyzers" title="Permalink"></a></h3><p>TODO: example with the Agilent4294A.</p><h3 id="Multiple-devices"><a class="docs-heading-anchor" href="#Multiple-devices">Multiple devices</a><a id="Multiple-devices-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-devices" title="Permalink"></a></h3><p>Lets say you want to use a signal generator, power supply and oscilloscope all at once.</p><pre><code class="language-julia hljs">using TcpInstruments
using Plots; plotly()

scope = initialize(AgilentDSOX4034A)
pwr   = initialize(VersatilePower)
sg    = initialize(Keysight33612A)

set_mode_cw(sg)
set_function(sg, &quot;SIN&quot;)
set_frequency(sg, 1000u&quot;Hz&quot;)
set_amplitude(sg, 0.1u&quot;A&quot;)
set_voltage_offset(sg, 0u&quot;V&quot;)
enable_output(sg)

set_voltage(pwr, 20u&quot;V&quot;)
set_current_limit(pwr, 4u&quot;A&quot;)
enable_output(pwr)

data_array = get_data(scope, [1,2])
plot(data_array)</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="instruments/">Supported Instruments »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 21 December 2022 18:00">Wednesday 21 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
